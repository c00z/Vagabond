<!-- User Profile page -->

<div class="container">
  <h2>Welcome, <%= @user.user_name %>!</h2>
  <hr>
  <div class="row">
    <div class="col m3">
      <ul>
      <%= image_tag @user.avatar.url(:thumb), id:"userprofileimg" %>
      <li>Current City: <%= @user.current_city %></li>
      <li>Member Since: <%= @user.created_at.strftime("%b %d, %Y") %></li>
      <% if current_user == @user %>
      <p><%= link_to "edit ",  edit_user_path(@user), :class => 'waves-effect waves-light btn' %></p>
      <% end %>
      </ul>
    </div>

    <div  class= "col m9">
      <div id="map" style='width: 700px; height: 350px; border: 3px black solid;'></div>
    </div>
  </div>
  <div class="col s8 offset-m2">
    <hr>
    <h3>Your Posts</h3>

    <% @user.posts.each do |p| %>
    <p><%= link_to "#{p.title}", post_path(p)%></p>
    <p><%=p.created_at.strftime("%b %d, %Y")%></p>
    <p><%= truncate p.content, length: 160 %></p>
    <hr>
    <% end %>
  </div>
</div>


<script type="text/javascript">
handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
markers = handler.addMarkers(<%=raw @hash.to_json %>);
handler.bounds.extendWith(markers);
handler.fitMapToBounds();
handler.map.centerOn([37.7749, -122.4194]);
});
</script>
